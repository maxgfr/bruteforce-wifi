[build]
# Universal optimizations for all platforms
# No forced target - adapts to your system automatically

[target.'cfg(all())']
rustflags = [
    # CPU-specific optimizations for native architecture
    "-C", "target-cpu=native",
]

# ARM64 optimizations (Apple Silicon M1/M2/M3)
[target.aarch64-apple-darwin]
rustflags = [
    # Use Apple M1 as baseline instead of native to avoid x86 features during cross-compilation
    "-C", "target-cpu=apple-m1",
    # Enable ARM crypto extensions for AES/SHA acceleration
    "-C", "target-feature=+neon,+crypto,+aes,+sha2",
]

# x86_64 optimizations (Intel Macs)
[target.x86_64-apple-darwin]
rustflags = [
    "-C", "target-cpu=native",
    # Enable Intel AES-NI and SHA extensions
    "-C", "target-feature=+aes,+sse2,+sse3,+sse4.1,+sse4.2,+avx,+avx2,+sha",
]
